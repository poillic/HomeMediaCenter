<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Media Center</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <audio controls>
        <source src="music/AURORA - Animal.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    <h1>ðŸŽµ Local Music Server</h1>
    <ul id="music-list"></ul>

    <form class="add_track_form" action="/upload" enctype="multipart/form-data" method="POST">
        <h2>Add Track</h2>
        <div>
            <label for="musicName">Title</label>
            <input type="text" name="trackName" placeholder="Music Name" required>
        </div>
        <div>
            <label for="musicName">Artist</label>
            <input type="text" name="trackArtist" placeholder="Artist Name">
        </div>
        <div>
            <label for="musicName">Album</label>
            <input type="text" name="trackAlbum" placeholder="Album Name">
        </div>
        <div>
            <input type="file" name="musicFile" accept="audio/*" required>
        </div>
        <button type="submit">Upload Music</button>
    </form>

    <script>

        let mainAudio = document.querySelector("audio");

        fetch("/api/music")
            .then(res => res.json())
            .then(files => {
                const list = document.getElementById("music-list");
                files.forEach(file => {
                    const li = document.createElement("li");
                    const a = document.createElement("a");
                    mainAudio.src = file.url;
                    a.textContent = file.name + " ";
                    a.addEventListener("click", (e) => {
                        e.preventDefault();
                        mainAudio.src = file.url;
                        mainAudio.play();
                    });
                    li.appendChild(a);
                    list.appendChild(li);
                });
            });
    </script>
</body>

</html>